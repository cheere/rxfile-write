/*!
 * rxfile-write
 * version: 0.0.4
 * repo: https://github.com/cheere/rxfile-write
 * build: 2021-11-12 10:08:12
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("fs"),require("path")):"function"==typeof define&&define.amd?define(["fs","path"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).fs,e.path)}(this,(function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=n(e),r=n(t);const c={error:function(e){if(e)e="unknow";else if("object"==typeof err)return err;return new Error("RxfileWrite-error=> read.js -> "+err)}},o={exists:function(e){const t=this;return new Promise(((n,r)=>{e?i.default.stat(e,((e,i)=>{e?r(e):i.isDirectory()?n({dir:!0,file:!1}):i.isFile()?n({dir:!1,file:!0}):r(t.error("RxfileWrite-exist=> stats not dir/file"))})):r(t.error("RxfileWrite-exist=> path undefined"))}))},existsSync:function(e){const t=this;if(!e)return t.error("RxfileWrite-existsSync=> path undefined"),{dir:!1,file:!1};const n=i.default.statSync(e);return n.isDirectory()?{dir:!0,file:!1}:n.isFile()?{dir:!1,file:!0}:(t.error("RxfileWrite-exist=> stats not dir/file"),{dir:!1,file:!1})}},s={};s.read=function(e){const t=this;return new Promise(((n,r)=>{t.exists(e).then((()=>{(function(e){return new Promise(((t,n)=>{i.default.readFile(e,"utf-8",((e,i)=>{e?n(e):t(i)}))}))})(e).then((e=>{n(e)})).catch((e=>{r(e)}))})).catch((e=>{r(e)}))}))};const f={};f.cp=function(e,t){const n=this;return new Promise(((r,c)=>{n.exists(e).then((()=>{(function(e,t){return new Promise(((n,r)=>{i.default.copyFile(e,t,(function(e){e?r(e):n()}))}))})(e,t).then((()=>{r()})).catch((e=>{c(e)}))})).catch((e=>{c(e)}))}))},f.cpSync=function(e,t){return!!this.existsSync(e).file&&function(e,t){try{i.default.copyFileSync(e,t)}catch(e){return!1}return!0}(e,t)};const u={write:function(e,t){return this.writeTo(e,t)},writeSync:function(e,t){h(e,t)},writeAppend:function(e,t){return this.writeTo(e,t,!0)},writeAppendSync:function(e,t){h(e,t,!0)}};u.writeTo=function(e,t,n=!1){return new Promise(((c,o)=>{const s=r.default.dirname(e);this.exists(s).then((()=>{d(e,t,n).then(c).catch(o)})).catch((()=>{(function(e){return new Promise(((t,n)=>{i.default.mkdir(e,{mode:a,flag:"w+"},(function(e){e?n(e):t()}))}))})(e).then((()=>{d(e,t,n).then(c).catch(o)})).catch(o)}))}))};const a=parseInt("0755",8),l=parseInt("0666",8);function d(e,t,n=!1){let r="w+",c=i.default.writeFile;return n&&(c=i.default.appendFile,r="as+"),new Promise(((n,i)=>{c(e,t,{encoding:"utf8",mode:l,flag:r},(function(e){e?i(e):n()}))}))}function h(e,t,n=!1){let r="w+",c=i.default.writeFileSync;n&&(c=i.default.appendFileSync,r="as+");try{c(e,t,{encoding:"utf8",mode:l,flag:r})}catch(e){console.error(e)}}const y={};function p(e){let t=[];i.default.existsSync(e)&&(t=i.default.readdirSync(e),t.forEach((t=>{const n=e+"/"+t;i.default.statSync(n).isDirectory()?p(n):i.default.unlinkSync(n)})),i.default.rmdirSync(e))}y.remove=function(e){const t=this;return new Promise(((n,r)=>{t.exists(e).then((()=>{(function(e){return new Promise(((t,n)=>{try{i.default.statSync(e).isDirectory()?p(e):i.default.unlinkSync(e),t()}catch(e){console.log("RxfileWrite-remove=> error=",e),n(e)}}))})(e).then((()=>{n()})).catch((e=>{r(e)}))})).catch((e=>{r(e)}))}))};const w=Object.assign(o,s,f,u,y),m=Object.assign(c,w);m.version='"0.0.4"',module.exports=m}));
