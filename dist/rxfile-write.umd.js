/*!
 * rxfile-write
 * version: 0.0.1
 * repo: https://github.com/cheere/rxfile-write
 * build: 2021-10-22 18:24:39
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("fs"),require("path")):"function"==typeof define&&define.amd?define(["fs","path"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).fs,e.path)}(this,(function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=n(e),i=n(t);const o={error:function(e){if(e)e="unknow";else if("object"==typeof err)return err;return new Error("rxrrw-error=> read.js -> "+err)}},c={exists:function(e){const t=this;return new Promise(((n,i)=>{e?r.default.stat(e,((e,r)=>{e?i(e):r.isDirectory()?n({dir:!0,file:!1}):r.isFile()?n({dir:!1,file:!0}):i(t.error("rxrrw-exist=> stats not dir/file"))})):i(t.error("rxrrw-exist=> path undefined"))}))}},s={};s.read=function(e){const t=this;return new Promise(((n,i)=>{t.exists(e).then((()=>{(function(e){return new Promise(((t,n)=>{r.default.readFile(e,"utf-8",((e,r)=>{e?n(e):t(r)}))}))})(e).then((e=>{n(e)})).catch((e=>{i(e)}))})).catch((e=>{i(e)}))}))};const f={write:function(e,t){return this.writeTo(e,t)},writeSync:function(e,t){l(e,t)},writeAppend:function(e,t){return this.writeTo(e,t,!0)},writeAppendSync:function(e,t){l(e,t,!0)}};f.writeTo=function(e,t,n=!1){return new Promise(((o,c)=>{const s=i.default.dirname(e);this.exists(s).then((()=>{d(e,t,n).then(o).catch(c)})).catch((()=>{(function(e){return new Promise(((t,n)=>{r.default.mkdir(e,{mode:u,flag:"w+"},(function(e){e?n(e):t()}))}))})(e).then((()=>{d(e,t,n).then(o).catch(c)})).catch(c)}))}))};const u=parseInt("0755",8),a=parseInt("0666",8);function d(e,t,n=!1){let i="w+",o=r.default.writeFile;return n&&(o=r.default.appendFile,i="as+"),new Promise(((n,r)=>{o(e,t,{encoding:"utf8",mode:a,flag:i},(function(e){e?r(e):n()}))}))}function l(e,t,n=!1){let i="w+",o=r.default.writeFileSync;n&&(o=r.default.appendFileSync,i="as+");try{o(e,t,{encoding:"utf8",mode:a,flag:i})}catch(e){console.error(e)}}const h={};function w(e){let t=[];r.default.existsSync(e)&&(t=r.default.readdirSync(e),t.forEach((t=>{const n=e+"/"+t;r.default.statSync(n).isDirectory()?w(n):r.default.unlinkSync(n)})),r.default.rmdirSync(e))}h.remove=function(e){const t=this;return new Promise(((n,i)=>{t.exists(e).then((()=>{(function(e){return new Promise(((t,n)=>{try{r.default.statSync(e).isDirectory()?w(e):r.default.unlinkSync(e),t()}catch(e){console.log("rxrrw-remove=> error=",e),n(e)}}))})(e).then((()=>{n()})).catch((e=>{i(e)}))})).catch((e=>{i(e)}))}))};const p=Object.assign(c,s,f,h),y=Object.assign(o,p);y.version='"0.0.1"',module.exports=y}));
