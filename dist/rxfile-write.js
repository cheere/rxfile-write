/*!
 * rxfile-write
 * version: 0.0.4
 * repo: https://github.com/cheere/rxfile-write
 * build: 2021-10-29 14:55:00
 */
"use strict";var t=require("fs"),e=require("path");function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=r(t),i=r(e);const c={error:function(t){if(t)t="unknow";else if("object"==typeof err)return err;return new Error("rxrrw-error=> read.js -> "+err)}},o={exists:function(t){const e=this;return new Promise(((r,i)=>{t?n.default.stat(t,((t,n)=>{t?i(t):n.isDirectory()?r({dir:!0,file:!1}):n.isFile()?r({dir:!1,file:!0}):i(e.error("rxrrw-exist=> stats not dir/file"))})):i(e.error("rxrrw-exist=> path undefined"))}))},existsSync:function(t){const e=this;if(!t)return e.error("rxrrw-existsSync=> path undefined"),{dir:!1,file:!1};const r=n.default.statSync(t);return r.isDirectory()?{dir:!0,file:!1}:r.isFile()?{dir:!1,file:!0}:(e.error("rxrrw-exist=> stats not dir/file"),{dir:!1,file:!1})}},s={};s.read=function(t){const e=this;return new Promise(((r,i)=>{e.exists(t).then((()=>{(function(t){return new Promise(((e,r)=>{n.default.readFile(t,"utf-8",((t,n)=>{t?r(t):e(n)}))}))})(t).then((t=>{r(t)})).catch((t=>{i(t)}))})).catch((t=>{i(t)}))}))};const u={};u.cp=function(t,e){const r=this;return new Promise(((i,c)=>{r.exists(t).then((()=>{(function(t,e){return new Promise(((r,i)=>{n.default.copyFile(t,e,(function(t){t?i(t):r()}))}))})(t,e).then((()=>{i()})).catch((t=>{c(t)}))})).catch((t=>{c(t)}))}))},u.cpSync=function(t,e){return!!this.existsSync(t).file&&function(t,e){try{n.default.copyFileSync(t,e)}catch(t){return!1}return!0}(t,e)};const f={write:function(t,e){return this.writeTo(t,e)},writeSync:function(t,e){h(t,e)},writeAppend:function(t,e){return this.writeTo(t,e,!0)},writeAppendSync:function(t,e){h(t,e,!0)}};f.writeTo=function(t,e,r=!1){return new Promise(((c,o)=>{const s=i.default.dirname(t);this.exists(s).then((()=>{d(t,e,r).then(c).catch(o)})).catch((()=>{(function(t){return new Promise(((e,r)=>{n.default.mkdir(t,{mode:a,flag:"w+"},(function(t){t?r(t):e()}))}))})(t).then((()=>{d(t,e,r).then(c).catch(o)})).catch(o)}))}))};const a=parseInt("0755",8),l=parseInt("0666",8);function d(t,e,r=!1){let i="w+",c=n.default.writeFile;return r&&(c=n.default.appendFile,i="as+"),new Promise(((r,n)=>{c(t,e,{encoding:"utf8",mode:l,flag:i},(function(t){t?n(t):r()}))}))}function h(t,e,r=!1){let i="w+",c=n.default.writeFileSync;r&&(c=n.default.appendFileSync,i="as+");try{c(t,e,{encoding:"utf8",mode:l,flag:i})}catch(t){console.error(t)}}const w={};function y(t){let e=[];n.default.existsSync(t)&&(e=n.default.readdirSync(t),e.forEach((e=>{const r=t+"/"+e;n.default.statSync(r).isDirectory()?y(r):n.default.unlinkSync(r)})),n.default.rmdirSync(t))}w.remove=function(t){const e=this;return new Promise(((r,i)=>{e.exists(t).then((()=>{(function(t){return new Promise(((e,r)=>{try{n.default.statSync(t).isDirectory()?y(t):n.default.unlinkSync(t),e()}catch(t){console.log("rxrrw-remove=> error=",t),r(t)}}))})(t).then((()=>{r()})).catch((t=>{i(t)}))})).catch((t=>{i(t)}))}))};const p=Object.assign(o,s,u,f,w),m=Object.assign(c,p);m.version='"0.0.4"',module.exports=m;
